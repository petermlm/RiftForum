FROM golang:1.12

ENV GO111MODULE=on
WORKDIR /go/src/app

# Install air
RUN apt install -y curl
RUN mkdir -p /air_run
RUN curl -fLo /air_run/air https://raw.githubusercontent.com/cosmtrek/air/master/bin/linux/air
RUN chmod +x /air_run/air

# Create user
RUN useradd -m -s /bin/bash dockeruser
USER dockeruser

# Prepare packages
COPY go.mod .
COPY go.sum .
RUN go mod download

# Copy rest of code base
COPY . .
